#!/bin/sh

# MacOS
if [ "$(uname -s)" = "Darwin" ]; then
    export PATH=/opt/homebrew/bin:$PATH
    if [ -n "$ZSH_VERSION" ]; then
      test -e "${HOME}/.iterm2_shell_integration.zsh" && source "${HOME}/.iterm2_shell_integration.zsh"
    fi
fi

#Local env
LOCAL_ENV="$HOME/.envrc.local"
if [ -f $LOCAL_ENV ]; then
    source $LOCAL_ENV
fi

# env
if [ -n "$NVIM_LISTEN_ADDRESS" ]; then
    # neovim-remote
    export VISUAL="nvr -cc split --remote-wait +'set bufhidden=wipe'"
    export EDITOR="nvr -cc split --remote-wait +'set bufhidden=wipe'"
else
    export VISUAL="nvim"
    export EDITOR="nvim"
fi

export TERMINAL="kitty"
export VISUAL="kitty $EDITOR"
export BROWSER="chromium"

# bin
export PATH=$HOME/.emacs.d/bin:$HOME/.bin:$HOME/.local/bin:$PATH

# Enable colors
which dircolors &>/dev/null && eval "`dircolors -b`"

# Add some colour to LESS/MAN pages
export LESSOPEN="| /usr/bin/source-highlight-esc.sh %s"
export LESS='-R'

export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;33m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;42;30m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;36m'

# fzf
export FZF_DEFAULT_COMMAND='rg --hidden --ignore .git -g ""'
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"

# fnm
export PATH=/home/ianmethyst/.fnm:$PATH
eval "`fnm env`"

# Python

# pip
export PIP_REQUIRE_VIRTUALENV=true
export PIP_DOWNLOAD_CACHE=$HOME/.pip/cache
export PYTHON_KEYRING_BACKEND=keyring.backends.SecretService.Keyring

# pyenv
export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv 1>/dev/null 2>&1; then eval "$(pyenv init -)"; fi

# pipenv
export PIPENV_VENV_IN_PROJECT=1
export PIPENV_SKIP_LOCK=true
export PIPENV_PYTHON=$PYENV_ROOT/shims/python
test -n "$ZSH_VERSION" && eval "$(_PIPENV_COMPLETE=zsh_source pipenv)"
test -n "$BASH_VERSION" && eval "$(_PIPENV_COMPLETE=bash_source pipenv)"

# Netlify
if [ -n "$ZSH_VERSION" ]; then
    test -f "$HOME/.config/netlify/helper/path.zsh.inc" && source "$HOME/.config/netlify/helper/path.zsh.inc"
fi

# fzf
if [ -n "$ZSH_VERSION" ]; then
  OS=`uname -s`
  if [ $OS = 'Linux' ]; then
    source /usr/share/fzf/key-bindings.zsh
    source /usr/share/fzf/completion.zsh
  elif [ $OS = 'Darwin' ]; then
    for line in `brew list fzf | grep .zsh$`; do source "$line"; done
  fi
fi

